package org.geoserver.wfs.format.ext;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.Set;
import java.util.AbstractMap.SimpleImmutableEntry;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import java.util.Map.Entry;

import javax.script.Invocable;
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

import org.geoserver.config.GeoServer;
import org.geoserver.platform.Operation;
import org.geoserver.wfs.json.GeoJSONGetFeatureResponse;
import org.geoserver.wfs.request.FeatureCollectionResponse;
import org.geotools.feature.FeatureCollection;
import org.opengis.feature.Feature;
import org.opengis.feature.Property;

import com.siemens.ct.exi.EXIFactory;
import com.siemens.ct.exi.exceptions.EXIException;
import com.siemens.ct.exi.helpers.DefaultEXIFactory;
import com.siemens.ct.exi.json.EXIforJSONGenerator;
import com.siemens.ct.exi.json.EXIforJSONParser;
import com.vividsolutions.jts.triangulate.VoronoiDiagramBuilder;

public class JsonEXIOutputFormat extends GeoJSONGetFeatureResponse {
	
	private String formatInstance = "";
	
	/**
	 * Actually the format is no use here. another class named "JsonEXIOutputFormatWithJava" is in charge for the json decoding with java engine
	 * @param geoServer
	 * @param format
	 */
	public JsonEXIOutputFormat(GeoServer geoServer, String format) {
		super(geoServer, format);
		this.formatInstance = format;
	}

	protected void write(FeatureCollectionResponse featureCollection, OutputStream output,
			Operation getFeature) throws IOException {

		ByteArrayOutputStream jsonOutputStream = new ByteArrayOutputStream();
		super.write(featureCollection, jsonOutputStream, getFeature);
		Date date_begin = new Date();
		if(formatInstance.toLowerCase().indexOf("javaexicommonstring")>=0){
			System.out.println("Retrieve common string of Json");
			ArrayList<String> commonStrings = WFSEXICommonMethods.extractCommonStringsFromFeatureCollection(featureCollection);
			String sharedStrings = String.join(", ", commonStrings);
			output.write(sharedStrings.getBytes());
		}else if(formatInstance.toLowerCase().indexOf("java")>=0){
			System.out.println("Encode by Java");
			encodingJSONIntoEXIByJava(featureCollection, jsonOutputStream, output);
			Date date_end = new Date();
	        System.out.println("Time for JSON-EXI-Java compression = "+(date_end.getTime() - date_begin.getTime()));
//	        ByteArrayOutputStream sizeOS = new ByteArrayOutputStream();
//	        encodingJSONIntoEXIByJava(featureCollection, jsonOutputStream, sizeOS);
//	        System.out.println("Size for JSON-EXI-Java compression = "+(sizeOS.size()));
		}else{
			System.out.println("Encode by JavaScript");
			encodingJSONIntoEXIByJavaScript(featureCollection, jsonOutputStream, output);
			Date date_end = new Date();
	        System.out.println("Time for JSON-EXI-JavaScript compression = "+(date_end.getTime() - date_begin.getTime()));
//	        ByteArrayOutputStream sizeOS = new ByteArrayOutputStream();
//	        encodingJSONIntoEXIByJavaScript(featureCollection, jsonOutputStream, sizeOS);
//	        
//	        EXIFactory ef = DefaultEXIFactory.newInstance();
//	        ArrayList<String> commonStrings = WFSEXICommonMethods.extractCommonStringsFromFeatureCollection(featureCollection);
//			ef.setSharedStrings(commonStrings);
//			
//	        System.out.println("Size for JSON-EXI-JavaScript compression = "+((sizeOS).size()));
		}
		
	}
	

	
	@Override
	public String getMimeType(Object value, Operation operation) {
		if(formatInstance.toLowerCase().indexOf("javaexicommonstring")>=0){
			return "applicationjson.text/text; subtype=text";
		}else if(formatInstance.toLowerCase().indexOf("java")>=0){
			return "applicationjson.java.exi/java.exi; subtype=json";
		}else{
			return "applicationjson.exi/exi; subtype=json";
		}
		
	}
	
	/**
	 * encode the json string into exi format. 
	 * Since the result cannot be decoded by the exi code at javascript side currently, now we use 
	 * @param jsonOutputStream
	 * @param originalOutputStream
	 */
	protected void encodingJSONIntoEXIByJava(FeatureCollectionResponse featureCollection, ByteArrayOutputStream jsonOutputStream, OutputStream originalOutputStream){
		InputStream jsonInputStream = new ByteArrayInputStream(jsonOutputStream.toByteArray());
		try {
//	        ArrayList<String> commonStrings = WFSEXICommonMethods.extractCommonStringsFromFeatureCollection(featureCollection);
			EXIFactory ef = DefaultEXIFactory.newInstance();
//			ef.setSharedStrings(commonStrings);
			
			EXIforJSONGenerator e4jGenerator = new EXIforJSONGenerator(ef);
			e4jGenerator.generate(jsonInputStream, originalOutputStream);
		} catch (Exception ex) {
			System.err.println(ex.getMessage());
		}
	}
	
	
	/**
	 * reference: https://github.com/EXIficient/exificient.js  Java test code
	 * https://docs.oracle.com/javase/8/docs/jdk/api/nashorn/jdk/nashorn/api/scripting/ScriptObjectMirror.html
	 * @param jsonOutputStream
	 * @param originalOutputStream
	 * @throws ScriptException 
	 * @throws NoSuchMethodException 
	 * @throws IOException 
	 */
	protected void encodingJSONIntoEXIByJavaScript(FeatureCollectionResponse featureCollection, ByteArrayOutputStream jsonOutputStream, OutputStream originalOutputStream) throws IOException{
		try{
			if(engine == null){
				ScriptEngineManager engineManager = new ScriptEngineManager();
				engine = engineManager.getEngineByName("JavaScript");
				// evaluate JS code
				engine.eval(EXIJsonJavaScritpEngineString);
				engine.eval("var exiEncoder = new EXI4JSONEncoder();");
			}
	        // javax.script.Invocable is an optional interface.
	        // Check whether your script engine implements or not!
	        // Note that the JavaScript engine implements Invocable interface.
	        Invocable inv = (Invocable) engine;

	        // get script object on which we want to call the method
	        Object obj = engine.get("exiEncoder");
	        
	        // set the shared string methods
	        ArrayList<String> commonStrings = WFSEXICommonMethods.extractCommonStringsFromFeatureCollection(featureCollection);
	        for(int i=0; i<commonStrings.size(); i++){
	        	commonStrings.set(i, "\"" + commonStrings.get(i) + "\"");
	        }
			String sharedStrings = "[" + String.join(", ", commonStrings) + "]";
			inv.invokeMethod(obj, "setSharedStrings", sharedStrings);
			System.out.println(sharedStrings);
	        
	        // invoke the method named "encodeJsonText" on the script object "obj"
	        // according to the method in JavaScript, this method has no return
			obj = engine.get("exiEncoder");
	        inv.invokeMethod(obj, "encodeJsonText", jsonOutputStream.toString());  
	        
	        // the result of this method is the instance of [jdk.nashorn.api.scripting.ScriptObjectMirror]
	        jdk.nashorn.api.scripting.ScriptObjectMirror objResult = (jdk.nashorn.api.scripting.ScriptObjectMirror)inv.invokeMethod(obj, "getUint8Array"); 
	    	Set<Entry<String, Object>> byteSet = objResult.entrySet();
	    	Object[] objArray = byteSet.toArray();
	    	byte[] byteArray = new byte[objArray.length];
	    	for(int i=0; i<objArray.length; i++){
	    		byteArray[i] = (byte)(int)((SimpleImmutableEntry) objArray[i]).getValue();
	    	}
	    	originalOutputStream.write(byteArray);
		}catch(Exception e){
			originalOutputStream.write(e.getMessage().getBytes());
		}
		
	}
	
	
	public static ScriptEngine engine = null;
	// The Javascript file for EXI encoding is wrapped into a single string
	// reference: http://jscompress.com/
	// replace all \ with \\ and " with \" before using
	public static final String EXIJsonJavaScritpEngineString = "function StringTable(){function e(e,t,a,r,n){this.namespaceID=e,this.localNameID=t,this.value=a,this.globalValueID=r,this.localValueID=n}this.strings=[],StringTable.prototype.getNumberOfGlobalStrings=function(){return this.strings.length},StringTable.prototype.getNumberOfLocalStrings=function(e,t){for(var a=0,r=0;r<this.strings.length;r++)this.strings[r].namespaceID===e&&this.strings[r].localNameID===t&&a++;return a},StringTable.prototype.getLocalValue=function(e,t,a){for(var r=a;r<this.strings.length;r++)if(this.strings[r].namespaceID===e&&this.strings[r].localNameID===t&&this.strings[r].localValueID===a)return this.strings[r];return null},StringTable.prototype.getGlobalValue=function(e){return this.strings.length>e?this.strings[e]:null},StringTable.prototype.addValue=function(t,a,r){var n=this.strings.length,m=this.getNumberOfLocalStrings(t,a);this.strings.push(new e(t,a,r,n,m))},StringTable.prototype.getStringTableEntry=function(e){for(var t=0;t<this.strings.length;t++)if(this.strings[t].value===e)return this.strings[t];return null}}function AbtractEXICoder(e){this.grammars=e,this.isStrict=!0,this.stringTable,this.sharedStrings,AbtractEXICoder.prototype.setSharedStrings=function(e){this.sharedStrings=e},AbtractEXICoder.prototype.init=function(){if(this.stringTable=new StringTable,null!=this.sharedStrings&&this.sharedStrings instanceof Array)for(var e=0;e<this.sharedStrings.length;e++)this.stringTable.addValue(-1,-1,this.sharedStrings[e])},AbtractEXICoder.prototype.getCodeLength=function(e){if(0>e)throw new Error(\"Error: Code length for \"+e+\" not possible\");return 2>e?0:3>e?1:5>e?2:9>e?3:17>e?4:33>e?5:35>e?6:129>e?7:257>e?8:513>e?9:1025>e?10:2049>e?11:4097>e?12:8193>e?13:16385>e?14:32769>e?15:Math.ceil(Math.log(e)/Math.log(2))},AbtractEXICoder.prototype.getCodeLengthForGrammar=function(e){if(\"document\"===e.type||\"fragment\"===e.type)return 0;if(\"docContent\"===e.type)return this.getCodeLength(e.production.length);if(\"docEnd\"===e.type||\"fragmentContent\"===e.type)return 0;if(\"firstStartTagContent\"===e.type)return this.isStrict?this.getCodeLength(e.production.length+(e.isTypeCastable||e.isNillable?1:0)):this.getCodeLength(e.production.length+1);if(\"startTagContent\"===e.type)return this.isStrict?this.getCodeLength(e.production.length):this.getCodeLength(e.production.length+1);if(\"elementContent\"===e.type)return this.isStrict?this.getCodeLength(e.production.length):this.getCodeLength(e.production.length+1);throw new Error(\"Unknown grammar type: \"+e.type)}}function BitInputStream(e){ERROR_EOF=-3,this.uint8Array=new Uint8Array(e),this.buffer=0,this.capacity=0,this.pos=0,this.errn=0,BitInputStream.prototype.readBuffer=function(){0===this.capacity&&(this.uint8Array.length>this.pos?(this.buffer=this.uint8Array[this.pos++],this.capacity=8):this.errn=ERROR_EOF)},BitInputStream.prototype.decodeNBitUnsignedInteger=function(e){if(0>e)throw new Error(\"Error in decodeNBitUnsignedInteger, nbits = \"+e);if(0===e)return 0;if(this.readBuffer(),0===this.errn){if(e<=this.capacity){this.capacity=this.capacity-e;var t=this.buffer>>this.capacity&255>>8-e;return t}if(0===this.capacity&&8===e)return this.uint8Array[this.pos];var t=this.buffer&255>>8-this.capacity;for(e-=this.capacity,this.capacity=0;0===this.errn&&e>=8;)this.readBuffer(),t=t<<8|this.buffer,e-=8,this.capacity=0;return 0===this.errn&&e>0&&(this.readBuffer(),0===this.errn&&(t=t<<e|this.buffer>>8-e,this.capacity=8-e)),t}return-1},BitInputStream.prototype.decodeUnsignedInteger=function(){for(var e=0,t=1,a=this.decodeNBitUnsignedInteger(8);a>=128;)e+=t*(a-128),a=this.decodeNBitUnsignedInteger(8),t=128*t;return e+=t*a},BitInputStream.prototype.decodeInteger=function(){return 0===this.decodeNBitUnsignedInteger(1)?this.decodeUnsignedInteger():-(this.decodeUnsignedInteger()+1)},BitInputStream.prototype.decodeStringOnly=function(e){var t,a=\"\";for(t=0;e>t;t++){var r=this.decodeUnsignedInteger();a+=String.fromCharCode(r)}return a}}function EXIDecoder(e){EXIDecoder.baseConstructor.call(this,e),this.bitStream,this.eventHandler=[],EXIDecoder.prototype.registerEventHandler=function(e){this.eventHandler.push(e)},EXIDecoder.prototype.decodeHeader=function(){var e=this.bitStream.decodeNBitUnsignedInteger(2);if(2!=e)throw new Error(\"Distinguishing Bits are \"+e);var t=this.bitStream.decodeNBitUnsignedInteger(1);if(0!=t)throw new Error(\"Do not support EXI Options in header\");var a=this.bitStream.decodeNBitUnsignedInteger(5);if(0!=a)throw new Error(\"Do not support format version \"+a);return 0},EXIDecoder.prototype.decodeDatatypeValue=function(e,t,a,r){if(\"STRING\"===e.type)this.decodeDatatypeValueString(t,a,r);else if(\"UNSIGNED_INTEGER\"===e.type)this.decodeDatatypeValueUnsignedInteger(t,a,r);else if(\"INTEGER\"===e.type)this.decodeDatatypeValueInteger(t,a,r);else if(\"FLOAT\"===e.type)this.decodeDatatypeValueFloat(t,a,r);else if(\"BOOLEAN\"===e.type)this.decodeDatatypeValueBoolean(t,a,r);else if(\"DATETIME\"===e.type)this.decodeDatatypeValueDateTime(e.datetimeType,t,a,r);else{if(\"LIST\"!==e.type)throw new Error(\"Unsupported datatype: \"+e.type);for(var n=this.bitStream.decodeUnsignedInteger(),m=0;m<this.eventHandler.length;m++){var s=this.eventHandler[m];if(!r)throw new Error(\"Unsupported LIST datatype attribute!!\");for(var m=0;n>m;m++)if(\"STRING\"===e.listType)this.decodeDatatypeValueString(t,a,!0),s.characters(\" \");else if(\"UNSIGNED_INTEGER\"===e.listType)this.decodeDatatypeValueUnsignedInteger(t,a,!0),s.characters(\" \");else if(\"INTEGER\"===e.listType)this.decodeDatatypeValueInteger(t,a,!0),s.characters(\" \");else if(\"FLOAT\"===e.listType)this.decodeDatatypeValueFloat(t,a,!0),s.characters(\" \");else{if(\"BOOLEAN\"!==e.listType)throw new Error(\"Unsupported list datatype: \"+e.listType+\" for value \"+value);this.decodeDatatypeValueBoolean(t,a,!0),s.characters(\" \")}}}},EXIDecoder.prototype.decodeDatatypeValueString=function(e,t,a){var r,n=this.bitStream.decodeUnsignedInteger();switch(n){case 0:var m=this.getCodeLength(this.stringTable.getNumberOfLocalStrings(e,t)),s=this.bitStream.decodeNBitUnsignedInteger(m),l=this.stringTable.getLocalValue(e,t,s);r=l.value;break;case 1:var m=this.getCodeLength(this.stringTable.getNumberOfGlobalStrings()),o=this.bitStream.decodeNBitUnsignedInteger(m),i=this.stringTable.getGlobalValue(o);r=i.value;break;default:n-=2,0===n?r=\"\":(r=this.bitStream.decodeStringOnly(n),this.stringTable.addValue(e,t,r))}for(var n=0;n<this.eventHandler.length;n++){var c=this.eventHandler[n];if(a)c.characters(r);else{var I=this.grammars.qnames.namespaceContext[e],D=I.qnameContext[t];c.attribute(I.uri,D.localName,r)}}},EXIDecoder.prototype.decodeDatatypeValueUnsignedInteger=function(e,t,a){var r=this.bitStream.decodeUnsignedInteger();for(i=0;i<this.eventHandler.length;i++){var n=this.eventHandler[i];if(a)n.characters(r);else{var m=this.grammars.qnames.namespaceContext[e],s=m.qnameContext[t];n.attribute(m.uri,s.localName,r)}}},EXIDecoder.prototype.decodeDatatypeValueInteger=function(e,t,a){var r,n=this.bitStream.decodeInteger();for(r=0;r<this.eventHandler.length;r++){var m=this.eventHandler[r];if(a)m.characters(n);else{var s=this.grammars.qnames.namespaceContext[e],l=s.qnameContext[t];m.attribute(s.uri,l.localName,n)}}},EXIDecoder.prototype.decodeDatatypeValueFloat=function(e,t,a){var r,n=this.bitStream.decodeInteger(),m=this.bitStream.decodeInteger();for(r=0;r<this.eventHandler.length;r++){var s=this.eventHandler[r];if(a)s.characters(n+\"E\"+m);else{var l=this.grammars.qnames.namespaceContext[e],o=l.qnameContext[t];s.attribute(l.uri,o.localName,n+\"E\"+m)}}},EXIDecoder.prototype.decodeDatatypeValueBoolean=function(e,t,a){for(var r=0===this.bitStream.decodeNBitUnsignedInteger(1)?!1:!0,n=0;n<this.eventHandler.length;n++){var m=this.eventHandler[n];if(a)m.characters(r);else{var s=this.grammars.qnames.namespaceContext[e],l=s.qnameContext[t];m.attribute(s.uri,l.localName,r)}}},EXIDecoder.prototype.decodeDatatypeValueDateTime=function(e,t,a,r){var n=0,m=0,s=\"\";if(\"date\"!==e)throw new Error(\"Unsupported datetime type: \"+e);n=this.bitStream.decodeInteger()+2e3,s+=n,m=this.bitStream.decodeNBitUnsignedInteger(9);var l=Math.floor(m/32);s+=10>l?\"-0\"+l:\"-\"+l;var o=m-32*l;s+=\"-\"+o;var i=0===this.bitStream.decodeNBitUnsignedInteger(1)?!1:!0;if(i){this.bitStream.decodeNBitUnsignedInteger(11)-896}for(var c=0;c<this.eventHandler.length;c++){var I=this.eventHandler[c];if(r)I.characters(s);else{var D=this.grammars.qnames.namespaceContext[t],p=D.qnameContext[a];I.attribute(D.uri,p.localName,s)}}},EXIDecoder.prototype.decodeElementContext=function(t,a,r){for(var n=!1;!n;){var m=this.getCodeLengthForGrammar(t),s=this.bitStream.decodeNBitUnsignedInteger(m),l=t.production[s];switch(l.event){case\"startDocument\":var o;for(o=0;o<this.eventHandler.length;o++){var i=this.eventHandler[o];i.startDocument()}break;case\"endDocument\":var o;for(o=0;o<this.eventHandler.length;o++){var i=this.eventHandler[o];i.endDocument()}n=!0;break;case\"startElement\":var o,c=e.grs.grammar[l.startElementGrammarID],I=this.grammars.qnames.namespaceContext[l.startElementNamespaceID],D=I.qnameContext[l.startElementLocalNameID];for(o=0;o<this.eventHandler.length;o++){var i=this.eventHandler[o];i.startElement(I.uri,D.localName)}this.decodeElementContext(c,l.startElementNamespaceID,l.startElementLocalNameID);break;case\"endElement\":var o,p=this.grammars.qnames.namespaceContext[a],E=p.qnameContext[r];for(o=0;o<this.eventHandler.length;o++){var i=this.eventHandler[o];i.endElement(p.uri,E.localName)}n=!0;break;case\"attribute\":var h=this.grammars.simpleDatatypes[l.attributeDatatypeID],N=this.grammars.qnames.namespaceContext[l.attributeNamespaceID];N.qnameContext[l.attributeLocalNameID];this.decodeDatatypeValue(h,l.attributeNamespaceID,l.attributeLocalNameID,!1);break;case\"characters\":var h=this.grammars.simpleDatatypes[l.charactersDatatypeID];this.decodeDatatypeValue(h,a,r,!0);break;default:throw new Error(\"Unknown event \"+l.event)}t=e.grs.grammar[l.nextGrammarID]}},EXIDecoder.prototype.decode=function(t){this.init(),this.bitStream=new BitInputStream(t);var a=this.decodeHeader();if(0===a){var r=e.grs.grammar[e.grs.documentGrammarID];this.decodeElementContext(r,-1)}return a}}function XMLEventHandler(){this.xml,this.seOpen=!1,XMLEventHandler.prototype.getXML=function(){return this.xml},XMLEventHandler.prototype.startDocument=function(){this.xml=\"\"},XMLEventHandler.prototype.endDocument=function(){},XMLEventHandler.prototype.startElement=function(e,t){this.seOpen&&(this.xml+=\">\"),this.xml+=\"<\"+t,this.seOpen=!0},XMLEventHandler.prototype.endElement=function(e,t){this.seOpen&&(this.xml+=\">\",this.seOpen=!1),this.xml+=\"</\"+t+\">\"},XMLEventHandler.prototype.characters=function(e){this.seOpen&&(this.xml+=\">\",this.seOpen=!1),this.xml+=e},XMLEventHandler.prototype.attribute=function(e,t,a){this.xml+=\" \"+t+'=\"'+a+'\"'}}function BitOutputStream(){this.uint8Array=new Uint8Array(8),this.buffer=0,this.capacity=8,this.len=0,this.errn=0,BitOutputStream.prototype.checkBuffer=function(){if(this.len>=this.uint8Array.length){for(var e=new Uint8Array(2*this.uint8Array.length),t=0;t<this.uint8Array.length;t++)e[t]=this.uint8Array[t];this.uint8Array=e}},BitOutputStream.prototype.getUint8Array=function(){return this.uint8Array},BitOutputStream.prototype.getUint8ArrayLength=function(){return this.len},BitOutputStream.prototype.align=function(){this.capacity<8&&(this.checkBuffer(),this.uint8Array[this.len]=this.buffer<<this.capacity,this.capacity=8,this.buffer=0,this.len++)},BitOutputStream.prototype.encodeNBitUnsignedInteger=function(e,t){if(0===t);else if(t<=this.capacity)this.buffer=this.buffer<<t|e&255>>8-t,this.capacity-=t,0===this.capacity&&(this.checkBuffer(),this.uint8Array[this.len]=this.buffer,this.capacity=8,this.len++);else{for(this.buffer=this.buffer<<this.capacity|e>>>t-this.capacity&255>>8-this.capacity,t-=this.capacity,this.checkBuffer(),this.uint8Array[this.len]=this.buffer,this.len++;t>=8;)t-=8,this.checkBuffer(),this.uint8Array[this.len]=e>>>t,this.len++;this.buffer=e,this.capacity=8-t}},BitOutputStream.prototype.numberOf7BitBlocksToRepresent=function(e){return 128>e?1:16384>e?2:2097152>e?3:268435456>e?4:34359738368>e?5:4398046511104>e?6:562949953421312>e?7:72057594037927940>e?8:0x8000000000000000>e?9:10},BitOutputStream.prototype.encodeUnsignedInteger=function(e){if(128>e)this.encodeNBitUnsignedInteger(e,8);else{var t=this.numberOf7BitBlocksToRepresent(e);switch(t){case 10:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 9:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 8:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 7:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 6:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 5:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 4:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 3:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 2:this.encodeNBitUnsignedInteger(128|e,8),e>>>=7;case 1:this.encodeNBitUnsignedInteger(0|e,8)}}},BitOutputStream.prototype.encodeInteger=function(e){0>e?(this.encodeNBitUnsignedInteger(1,1),this.encodeUnsignedInteger(-e-1)):(this.encodeNBitUnsignedInteger(0,1),this.encodeUnsignedInteger(e))},BitOutputStream.prototype.encodeStringOnly=function(e){for(var t=0;t<e.length;t++){var a=e.charCodeAt(t);this.encodeUnsignedInteger(a)}}}function EXIEncoder(e){function t(e,t,a){this.namespaceID=e,this.localNameID=t,this.grammar=a}function a(e){var t=(\"\"+e).match(/(?:\\.(\\d+))?(?:[eE]([+-]?\\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}function r(e){if(\"number\"!=typeof e)throw new TypeError(\"value must be a Number\");var t={exponent:0,mantissa:0};if(0===e)return t;if(Number.isInteger(e))return t.mantissa=e,t;if(!isFinite(e))return t.exponent=-16384,isNaN(e)?t.mantissa=0:e===-(1/0)?t.mantissa=-1:t.mantissa=1,t;e=Number(Number(e).toFixed(6));var r=!1;0>e&&(r=!0,e=-e);var n=a(e);n>0&&(t.exponent=-n);for(var m=e;n>0;)m=10*m,n-=1;return t.mantissa=Math.round(m),r&&(t.mantissa=-t.mantissa),t}function n(){this.year,this.monthDay,this.error=0}function m(e,t){var a,r;\"-\"===e.charAt(0)?(a=e.substring(0,5),r=5):(a=e.substring(0,4),r=4);var n=parseInt(a);return t.year=n,r}function s(e,t,a,r){return e.length>t&&e.charAt(t)===a||(r.error=-1),t+1}function l(e,t,a){var r=parseInt(e.substring(t,t+2));t+=2,t=s(e,t,\"-\",a);var n=parseInt(e.substring(t,t+2));return t+=2,a.monthDay=32*r+n,t}EXIEncoder.baseConstructor.call(this,e),this.bitStream,this.elementContext,EXIEncoder.prototype.encodeXmlText=function(e){var t;if(\"undefined\"!=typeof window&&\"undefined\"!=typeof window.DOMParser){var a=function(e){return(new window.DOMParser).parseFromString(e,\"text/xml\")};t=a(e)}else if(\"undefined\"!=typeof window&&\"undefined\"!=typeof window.ActiveXObject&&new window.ActiveXObject(\"Microsoft.XMLDOM\")){var a=function(e){var t=new window.ActiveXObject(\"Microsoft.XMLDOM\");return t.async=\"false\",t.loadXML(e),t};t=a(e)}else{if(\"undefined\"==typeof javax.xml.parsers.DocumentBuilderFactory)throw new Error(\"No XML parser found\");var r=javax.xml.parsers.DocumentBuilderFactory.newInstance();r.setNamespaceAware(!0);var n=r.newDocumentBuilder();t=n.parse(new org.xml.sax.InputSource(new java.io.StringReader(e)))}this.encodeXmlDocument(t)},EXIEncoder.prototype.encodeXmlDocument=function(e){this.startDocument(),this.processXMLElement(e.documentElement),this.endDocument()},EXIEncoder.prototype.encodeHeader=function(){return this.bitStream.encodeNBitUnsignedInteger(2,2),this.bitStream.encodeNBitUnsignedInteger(0,1),this.bitStream.encodeNBitUnsignedInteger(0,1),this.bitStream.encodeNBitUnsignedInteger(0,4),0},EXIEncoder.prototype.processXMLElement=function(e){if(this.startElement(e.namespaceURI,e.localName),null!=e.attributes&&e.attributes.length>0)if(e.attributes.length>1){for(var t=[],a=0;a<e.attributes.length;a++){var r=e.attributes.item(a);t.push(r.localName)}t.sort();for(var a=0;a<t.length;a++){var r=e.getAttributeNode(t[a]);null!=r&&this.attribute(r.namespaceURI,r.localName,r.nodeValue)}}else{var n=e.attributes.item(0);this.attribute(n.namespaceURI,n.localName,n.nodeValue)}for(var m=e.childNodes,a=0;a<m.length;a++){var s=m.item(a);if(3===s.nodeType){var l=s.nodeValue;l=l.trim(),l.length>0&&this.characters(l)}1===s.nodeType&&this.processXMLElement(s)}this.endElement()},EXIEncoder.prototype.getUint8Array=function(){return this.bitStream.getUint8Array()},EXIEncoder.prototype.getUint8ArrayLength=function(){return this.bitStream.getUint8ArrayLength()},EXIEncoder.prototype.startDocument=function(){this.init(),this.bitStream=new BitOutputStream,this.elementContext=[],this.encodeHeader();for(var a,r=e.grs.grammar[e.grs.documentGrammarID],n=-1,m=0;-1===n&&m<r.production.length;m++)a=r.production[m],\"startDocument\"===a.event&&(n=m);if(-1==n)throw new Error(\"No startDocument event found\");var s=this.getCodeLengthForGrammar(r);this.bitStream.encodeNBitUnsignedInteger(n,s);var l=e.grs.grammar[a.nextGrammarID];this.elementContext.push(new t(-1,-1,l))},EXIEncoder.prototype.endDocument=function(){for(var e,t=-1,a=this.elementContext[this.elementContext.length-1].grammar,r=0;-1===t&&r<a.production.length;r++)e=a.production[r],\"endDocument\"===e.event&&(t=r);if(-1==t)throw new Error(\"No endDocument event found\");var n=this.getCodeLengthForGrammar(a);if(this.bitStream.encodeNBitUnsignedInteger(t,n),this.elementContext.pop(),0!=this.elementContext.length)throw new Error(\"Element context not balanced\");this.bitStream.align()},EXIEncoder.prototype.startElement=function(a,r){null===a&&(a=\"\");for(var n,m=-1,s=this.elementContext[this.elementContext.length-1].grammar,l=0;-1===m&&l<s.production.length;l++)if(n=s.production[l],\"startElement\"===n.event){var o=this.grammars.qnames.namespaceContext[n.startElementNamespaceID],i=o.qnameContext[n.startElementLocalNameID];i.localName===r&&o.uri===a&&(m=l)}if(-1==m)throw new Error(\"No startElement event found for \"+r);var c=this.getCodeLengthForGrammar(s);this.bitStream.encodeNBitUnsignedInteger(m,c);var I=e.grs.grammar[n.nextGrammarID];this.elementContext[this.elementContext.length-1].grammar=I;var D=e.grs.grammar[n.startElementGrammarID];this.elementContext.push(new t(n.startElementNamespaceID,n.startElementLocalNameID,D))},EXIEncoder.prototype.endElement=function(){for(var e,t=-1,a=this.elementContext[this.elementContext.length-1].grammar,r=0;-1===t&&r<a.production.length;r++)e=a.production[r],\"endElement\"===e.event&&(t=r);if(-1==t)throw new Error(\"No endElement event found\");var n=this.getCodeLengthForGrammar(a);this.bitStream.encodeNBitUnsignedInteger(t,n),this.elementContext.pop()},EXIEncoder.prototype.attribute=function(t,a,r){if(null===t&&(t=\"\"),\"http://www.w3.org/2000/xmlns/\"===t);else if(\"http://www.w3.org/2001/XMLSchema-instance\"===t);else{for(var n,m=-1,s=this.elementContext[this.elementContext.length-1].grammar,l=0;-1===m&&l<s.production.length;l++)if(n=s.production[l],\"attribute\"===n.event){var o=this.grammars.qnames.namespaceContext[n.attributeNamespaceID],i=o.qnameContext[n.attributeLocalNameID];i.localName===a&&o.uri===t&&(m=l)}if(-1==m)throw new Error(\"No attribute event found for \"+a);var c=this.getCodeLengthForGrammar(s);this.bitStream.encodeNBitUnsignedInteger(m,c);var I=this.grammars.simpleDatatypes[n.attributeDatatypeID];this.encodeDatatypeValue(r,I,n.attributeNamespaceID,n.attributeLocalNameID);var D=e.grs.grammar[n.nextGrammarID];this.elementContext[this.elementContext.length-1].grammar=D}},EXIEncoder.prototype.characters=function(t){for(var a,r=-1,n=this.elementContext[this.elementContext.length-1].grammar,m=0;-1===r&&m<n.production.length;m++)a=n.production[m],\"characters\"===a.event&&(r=m);if(-1==r)throw new Error(\"No characters event found for '\"+t+\"'\");var s=this.getCodeLengthForGrammar(n);this.bitStream.encodeNBitUnsignedInteger(r,s);var l=this.grammars.simpleDatatypes[a.charactersDatatypeID],o=this.elementContext[this.elementContext.length-1];this.encodeDatatypeValue(t,l,o.namespaceID,o.localNameID);var i=e.grs.grammar[a.nextGrammarID];this.elementContext[this.elementContext.length-1].grammar=i},Number.isInteger=Number.isInteger||function(e){return\"number\"==typeof e&&isFinite(e)&&Math.floor(e)===e},EXIEncoder.prototype.encodeDatatypeValue=function(e,t,a,r){if(\"STRING\"===t.type)this.encodeDatatypeValueString(e,a,r);else if(\"UNSIGNED_INTEGER\"===t.type)this.encodeDatatypeValueUnsignedInteger(e,a,r);else if(\"INTEGER\"===t.type)this.encodeDatatypeValueInteger(e,a,r);else if(\"FLOAT\"===t.type)this.encodeDatatypeValueFloat(e,a,r);else if(\"BOOLEAN\"===t.type)this.encodeDatatypeValueBoolean(e,a,r);else if(\"DATETIME\"===t.type)this.encodeDatatypeValueDateTime(e,t.datetimeType,a,r);else{if(\"LIST\"!==t.type)throw new Error(\"Unsupported datatype: \"+t.type+\" for value \"+e);var n=e.split(\" \");this.bitStream.encodeUnsignedInteger(n.length);for(var m=0;m<n.length;m++){var s=n[m];if(\"STRING\"===t.listType)this.encodeDatatypeValueString(s,a,r);else if(\"UNSIGNED_INTEGER\"===t.listType)this.encodeDatatypeValueUnsignedInteger(s,a,r);else if(\"INTEGER\"===t.listType)this.encodeDatatypeValueInteger(s,a,r);else if(\"FLOAT\"===t.listType)this.encodeDatatypeValueFloat(s,a,r);else{if(\"BOOLEAN\"!==t.listType)throw new Error(\"Unsupported list datatype: \"+t.listType+\" for value \"+e);this.encodeDatatypeValueBoolean(s,a,r)}}}},EXIEncoder.prototype.encodeDatatypeValueString=function(e,t,a){var r=this.stringTable.getStringTableEntry(e);if(null===r){var n=e.length;this.bitStream.encodeUnsignedInteger(2+n),n>0&&(this.bitStream.encodeStringOnly(e),this.stringTable.addValue(t,a,e))}else if(r.namespaceID===t&&r.localNameID===a){this.bitStream.encodeUnsignedInteger(0);var m=this.getCodeLength(this.stringTable.getNumberOfLocalStrings(t,a));this.bitStream.encodeNBitUnsignedInteger(r.localValueID,m)}else{this.bitStream.encodeUnsignedInteger(1);var m=this.getCodeLength(this.stringTable.getNumberOfGlobalStrings());this.bitStream.encodeNBitUnsignedInteger(r.globalValueID,m)}},EXIEncoder.prototype.encodeDatatypeValueUnsignedInteger=function(e,t,a){this.bitStream.encodeUnsignedInteger(e)},EXIEncoder.prototype.encodeDatatypeValueInteger=function(e,t,a){this.bitStream.encodeInteger(e)},EXIEncoder.prototype.encodeDatatypeValueFloat=function(e,t,a){var n=parseFloat(e),m=r(n);this.bitStream.encodeInteger(m.mantissa),this.bitStream.encodeInteger(m.exponent),exi4JSONEncoderCountEncodedFloat+=1,exi4JSONEncoderCountEncodedFloat%1e4==0},EXIEncoder.prototype.encodeDatatypeValueBoolean=function(e,t,a){e?this.bitStream.encodeNBitUnsignedInteger(1,1):this.bitStream.encodeNBitUnsignedInteger(0,1)},EXIEncoder.prototype.encodeDatatypeValueDateTime=function(e,t,a,r){var o=!1;if(\"date\"!==t)throw new Error(\"Unsupported datetime type: \"+t);var i=new n,c=m(e,i);c=s(e,c,\"-\",i),c=l(e,c,i),this.bitStream.encodeInteger(i.year-2e3),this.bitStream.encodeNBitUnsignedInteger(i.monthDay,9);var o=!1;if(o)throw this.bitStream.encodeNBitUnsignedInteger(1,1),new Error(\"Unsupported datetime timezone\");this.bitStream.encodeNBitUnsignedInteger(0,1)}}function EXI4JSONDecoder(){EXI4JSONDecoder.baseConstructor.call(this,jsonGrammarsObject)}function EXI4JSONEncoder(){EXI4JSONEncoder.baseConstructor.call(this,jsonGrammarsObject),EXI4JSONEncoder.prototype.encodeJsonText=function(e){var t=JSON.parse(e);this.encodeJsonObject(t)},EXI4JSONEncoder.prototype.encodeJsonObject=function(e){if(this.startDocument(),exi4JSONEncoderCountEncodedFloat=0,e instanceof Array)this.startElement(exiForJsonUri,\"array\"),this.processJSONArray(e),this.endElement();else{if(!(e instanceof Object))throw new Error(\"Neither array nor object root\");this.startElement(exiForJsonUri,\"map\"),this.processJSONObject(e),this.endElement()}this.endDocument()},EXI4JSONEncoder.prototype.processJSONArray=function(e){for(var t=e.length,a=0;t>a;a++){var r=e[a];if(r instanceof Array)this.startElement(exiForJsonUri,\"array\"),this.processJSONArray(r),this.endElement();else if(r instanceof Object)this.startElement(exiForJsonUri,\"map\"),this.processJSONObject(r),this.endElement();else if(\"string\"==typeof r)this.startElement(exiForJsonUri,\"string\"),this.characters(r),this.endElement();else if(\"number\"==typeof r)this.startElement(exiForJsonUri,\"number\"),this.characters(r),this.endElement();else if(\"boolean\"==typeof r)this.startElement(exiForJsonUri,\"boolean\"),this.characters(r),this.endElement();else{if(null!==r)throw new Error(\"Not supported object type: \"+typeof r);this.startElement(exiForJsonUri,\"null\"),this.endElement()}}},EXI4JSONEncoder.prototype.processJSONObject=function(e){Object.keys(e);for(var t in e)if(e.hasOwnProperty(t)){var a=e[t];if(a instanceof Array)this.startElement(exiForJsonUri,\"array\"),this.attribute(\"\",\"key\",t),this.processJSONArray(a),this.endElement();else if(a instanceof Object)this.startElement(exiForJsonUri,\"map\"),this.attribute(\"\",\"key\",t),this.processJSONObject(a),this.endElement();else if(\"string\"==typeof a)this.startElement(exiForJsonUri,\"string\"),this.attribute(\"\",\"key\",t),this.characters(a),this.endElement();else if(\"number\"==typeof a)this.startElement(exiForJsonUri,\"number\"),this.attribute(\"\",\"key\",t),this.characters(a),this.endElement();else if(\"boolean\"==typeof a)this.startElement(exiForJsonUri,\"boolean\"),this.attribute(\"\",\"key\",t),this.characters(a),this.endElement();else{if(null!==a)throw new Error(\"Not supported object type: \"+typeof a);this.startElement(exiForJsonUri,\"null\"),this.attribute(\"\",\"key\",t),this.endElement()}}}}function JSONEventHandler(){this.openTag,this.openTagKey,this.json,this.jsonStack,JSONEventHandler.prototype.getJSON=function(){return this.json},JSONEventHandler.prototype.startDocument=function(){this.openTag=null,this.openTagKey=null,this.json=null,this.jsonStack=[]},JSONEventHandler.prototype.endDocument=function(){},JSONEventHandler.prototype.checkOpenElement=function(){if(null!=this.openTag){var e=this.jsonStack[this.jsonStack.length-1],t=null;\"map\"===this.openTag?(t=new Object,this.jsonStack.push(t)):\"array\"===this.openTag&&(t=new Array,this.jsonStack.push(t)),null!=t&&(null===this.openTagKey?e.push(t):e[this.openTagKey]=t,this.openTag=null,this.openTagKey=null)}},JSONEventHandler.prototype.startElement=function(e,t){null===this.json?\"map\"===t?(this.json=new Object,this.jsonStack.push(this.json)):\"array\"===t&&(this.json=new Array,this.jsonStack.push(this.json)):(this.checkOpenElement(),this.openTag=t,this.openTagKey=null)},JSONEventHandler.prototype.endElement=function(e,t){if(\"null\"===this.openTag){var a=this.jsonStack[this.jsonStack.length-1];a instanceof Array?a.push(null):a instanceof Object&&(a[this.openTagKey]=null)}this.checkOpenElement(),\"map\"===t?this.jsonStack.pop():\"array\"===t&&this.jsonStack.pop()},JSONEventHandler.prototype.attribute=function(e,t,a){\"key\"===t&&(this.openTagKey=a)},JSONEventHandler.prototype.characters=function(e){var t=this.jsonStack[this.jsonStack.length-1];if(\"number\"===this.openTag){var a=new Number(e);t instanceof Array?t.push(a):t instanceof Object&&(t[this.openTagKey]=a)}else if(\"string\"===this.openTag){var r=new String(e);t instanceof Array?t.push(r):t instanceof Object&&(t[this.openTagKey]=r)}else{if(\"boolean\"!==this.openTag)throw new Error(\"Unsupported characters type: \"+this.openTag);var n=new Boolean(e);t instanceof Array?t.push(n):t instanceof Object&&(t[this.openTagKey]=n)}}}Inheritance_Manager={},Inheritance_Manager.extend=function(e,t){function a(){}a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e,e.baseConstructor=t,e.superClass=t.prototype},Inheritance_Manager.extend(EXIDecoder,AbtractEXICoder),Inheritance_Manager.extend(EXIEncoder,AbtractEXICoder),exiForJsonUri=\"http://www.w3.org/2015/EXI/json\",exi4JSONEncoderCountEncodedFloat=0,Inheritance_Manager.extend(EXI4JSONDecoder,EXIDecoder),Inheritance_Manager.extend(EXI4JSONEncoder,EXIEncoder);var jsonGrammars='{\"qnames\":{\"numberOfUris\":5,\"numberOfQNames\":73,\"namespaceContext\":[{\"uriID\":\"0\",\"uri\":\"\",\"numberOfLocalNames\":1,\"qnameContext\":[{\"localNameID\":0,\"localName\":\"key\"}]},{\"uriID\":\"1\",\"uri\":\"http://www.w3.org/XML/1998/namespace\",\"numberOfLocalNames\":4,\"qnameContext\":[{\"localNameID\":0,\"localName\":\"base\"},{\"localNameID\":1,\"localName\":\"id\"},{\"localNameID\":2,\"localName\":\"lang\"},{\"localNameID\":3,\"localName\":\"space\"}]},{\"uriID\":\"2\",\"uri\":\"http://www.w3.org/2001/XMLSchema-instance\",\"numberOfLocalNames\":2,\"qnameContext\":[{\"localNameID\":0,\"localName\":\"nil\"},{\"localNameID\":1,\"localName\":\"type\"}]},{\"uriID\":\"3\",\"uri\":\"http://www.w3.org/2001/XMLSchema\",\"numberOfLocalNames\":46,\"qnameContext\":[{\"localNameID\":0,\"localName\":\"ENTITIES\",\"globalTypeGrammarID\":26},{\"localNameID\":1,\"localName\":\"ENTITY\",\"globalTypeGrammarID\":9},{\"localNameID\":2,\"localName\":\"ID\",\"globalTypeGrammarID\":9},{\"localNameID\":3,\"localName\":\"IDREF\",\"globalTypeGrammarID\":9},{\"localNameID\":4,\"localName\":\"IDREFS\",\"globalTypeGrammarID\":26},{\"localNameID\":5,\"localName\":\"NCName\",\"globalTypeGrammarID\":9},{\"localNameID\":6,\"localName\":\"NMTOKEN\",\"globalTypeGrammarID\":9},{\"localNameID\":7,\"localName\":\"NMTOKENS\",\"globalTypeGrammarID\":26},{\"localNameID\":8,\"localName\":\"NOTATION\",\"globalTypeGrammarID\":9},{\"localNameID\":9,\"localName\":\"Name\",\"globalTypeGrammarID\":9},{\"localNameID\":10,\"localName\":\"QName\",\"globalTypeGrammarID\":9},{\"localNameID\":11,\"localName\":\"anySimpleType\",\"globalTypeGrammarID\":9},{\"localNameID\":12,\"localName\":\"anyType\",\"globalTypeGrammarID\":27},{\"localNameID\":13,\"localName\":\"anyURI\",\"globalTypeGrammarID\":9},{\"localNameID\":14,\"localName\":\"base64Binary\",\"globalTypeGrammarID\":14},{\"localNameID\":15,\"localName\":\"boolean\",\"globalTypeGrammarID\":11},{\"localNameID\":16,\"localName\":\"byte\",\"globalTypeGrammarID\":28},{\"localNameID\":17,\"localName\":\"date\",\"globalTypeGrammarID\":17},{\"localNameID\":18,\"localName\":\"dateTime\",\"globalTypeGrammarID\":15},{\"localNameID\":19,\"localName\":\"decimal\",\"globalTypeGrammarID\":19},{\"localNameID\":20,\"localName\":\"double\",\"globalTypeGrammarID\":10},{\"localNameID\":21,\"localName\":\"duration\",\"globalTypeGrammarID\":9},{\"localNameID\":22,\"localName\":\"float\",\"globalTypeGrammarID\":10},{\"localNameID\":23,\"localName\":\"gDay\",\"globalTypeGrammarID\":29},{\"localNameID\":24,\"localName\":\"gMonth\",\"globalTypeGrammarID\":30},{\"localNameID\":25,\"localName\":\"gMonthDay\",\"globalTypeGrammarID\":31},{\"localNameID\":26,\"localName\":\"gYear\",\"globalTypeGrammarID\":32},{\"localNameID\":27,\"localName\":\"gYearMonth\",\"globalTypeGrammarID\":33},{\"localNameID\":28,\"localName\":\"hexBinary\",\"globalTypeGrammarID\":34},{\"localNameID\":29,\"localName\":\"int\",\"globalTypeGrammarID\":18},{\"localNameID\":30,\"localName\":\"integer\",\"globalTypeGrammarID\":18},{\"localNameID\":31,\"localName\":\"language\",\"globalTypeGrammarID\":9},{\"localNameID\":32,\"localName\":\"long\",\"globalTypeGrammarID\":18},{\"localNameID\":33,\"localName\":\"negativeInteger\",\"globalTypeGrammarID\":18},{\"localNameID\":34,\"localName\":\"nonNegativeInteger\",\"globalTypeGrammarID\":35},{\"localNameID\":35,\"localName\":\"nonPositiveInteger\",\"globalTypeGrammarID\":18},{\"localNameID\":36,\"localName\":\"normalizedString\",\"globalTypeGrammarID\":9},{\"localNameID\":37,\"localName\":\"positiveInteger\",\"globalTypeGrammarID\":35},{\"localNameID\":38,\"localName\":\"short\",\"globalTypeGrammarID\":18},{\"localNameID\":39,\"localName\":\"string\",\"globalTypeGrammarID\":9},{\"localNameID\":40,\"localName\":\"time\",\"globalTypeGrammarID\":16},{\"localNameID\":41,\"localName\":\"token\",\"globalTypeGrammarID\":9},{\"localNameID\":42,\"localName\":\"unsignedByte\",\"globalTypeGrammarID\":36},{\"localNameID\":43,\"localName\":\"unsignedInt\",\"globalTypeGrammarID\":35},{\"localNameID\":44,\"localName\":\"unsignedLong\",\"globalTypeGrammarID\":35},{\"localNameID\":45,\"localName\":\"unsignedShort\",\"globalTypeGrammarID\":35}]},{\"uriID\":\"4\",\"uri\":\"http://www.w3.org/2015/EXI/json\",\"numberOfLocalNames\":20,\"qnameContext\":[{\"localNameID\":0,\"localName\":\"array\",\"globalElementGrammarID\":5},{\"localNameID\":1,\"localName\":\"arrayType\",\"globalTypeGrammarID\":5},{\"localNameID\":2,\"localName\":\"base64Binary\"},{\"localNameID\":3,\"localName\":\"boolean\",\"globalElementGrammarID\":11},{\"localNameID\":4,\"localName\":\"booleanType\",\"globalTypeGrammarID\":11},{\"localNameID\":5,\"localName\":\"date\"},{\"localNameID\":6,\"localName\":\"dateTime\"},{\"localNameID\":7,\"localName\":\"decimal\"},{\"localNameID\":8,\"localName\":\"integer\"},{\"localNameID\":9,\"localName\":\"map\",\"globalElementGrammarID\":6},{\"localNameID\":10,\"localName\":\"mapType\",\"globalTypeGrammarID\":6},{\"localNameID\":11,\"localName\":\"null\",\"globalElementGrammarID\":12},{\"localNameID\":12,\"localName\":\"nullType\",\"globalTypeGrammarID\":12},{\"localNameID\":13,\"localName\":\"number\",\"globalElementGrammarID\":10},{\"localNameID\":14,\"localName\":\"numberType\",\"globalTypeGrammarID\":10},{\"localNameID\":15,\"localName\":\"other\",\"globalElementGrammarID\":13},{\"localNameID\":16,\"localName\":\"otherType\",\"globalTypeGrammarID\":13},{\"localNameID\":17,\"localName\":\"string\",\"globalElementGrammarID\":9},{\"localNameID\":18,\"localName\":\"stringType\",\"globalTypeGrammarID\":9},{\"localNameID\":19,\"localName\":\"time\"}]}]},\"simpleDatatypes\":[{\"simpleDatatypeID\":0,\"type\":\"STRING\"},{\"simpleDatatypeID\":1,\"type\":\"STRING\"},{\"simpleDatatypeID\":2,\"type\":\"STRING\"},{\"simpleDatatypeID\":3,\"type\":\"FLOAT\"},{\"simpleDatatypeID\":4,\"type\":\"FLOAT\"},{\"simpleDatatypeID\":5,\"type\":\"BOOLEAN\"},{\"simpleDatatypeID\":6,\"type\":\"BOOLEAN\"},{\"simpleDatatypeID\":7,\"type\":\"BINARY_BASE64\"},{\"simpleDatatypeID\":8,\"type\":\"DATETIME\",\"datetimeType\":\"dateTime\"},{\"simpleDatatypeID\":9,\"type\":\"DATETIME\",\"datetimeType\":\"time\"},{\"simpleDatatypeID\":10,\"type\":\"DATETIME\",\"datetimeType\":\"date\"},{\"simpleDatatypeID\":11,\"type\":\"INTEGER\"},{\"simpleDatatypeID\":12,\"type\":\"DECIMAL\"},{\"simpleDatatypeID\":13,\"type\":\"LIST\",\"listType\":\"STRING\"},{\"simpleDatatypeID\":14,\"type\":\"LIST\",\"listType\":\"STRING\"},{\"simpleDatatypeID\":15,\"type\":\"NBIT_UNSIGNED_INTEGER\",\"lowerBound\":-128,\"upperBound\":127},{\"simpleDatatypeID\":16,\"type\":\"INTEGER\"},{\"simpleDatatypeID\":17,\"type\":\"DATETIME\",\"datetimeType\":\"gDay\"},{\"simpleDatatypeID\":18,\"type\":\"DATETIME\",\"datetimeType\":\"gMonth\"},{\"simpleDatatypeID\":19,\"type\":\"DATETIME\",\"datetimeType\":\"gMonthDay\"},{\"simpleDatatypeID\":20,\"type\":\"DATETIME\",\"datetimeType\":\"gYear\"},{\"simpleDatatypeID\":21,\"type\":\"DATETIME\",\"datetimeType\":\"gYearMonth\"},{\"simpleDatatypeID\":22,\"type\":\"BINARY_HEX\"},{\"simpleDatatypeID\":23,\"type\":\"UNSIGNED_INTEGER\"},{\"simpleDatatypeID\":24,\"type\":\"NBIT_UNSIGNED_INTEGER\",\"lowerBound\":0,\"upperBound\":255},{\"simpleDatatypeID\":25,\"type\":\"UNSIGNED_INTEGER\"}],\"grs\":{\"documentGrammarID\":0,\"fragmentGrammarID\":3,\"grammar\":[{\"grammarID\":\"0\",\"type\":\"document\",\"production\":[{\"event\":\"startDocument\",\"nextGrammarID\":1}]},{\"grammarID\":\"1\",\"type\":\"docContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":5,\"nextGrammarID\":2},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":11,\"nextGrammarID\":2},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":6,\"nextGrammarID\":2},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":12,\"nextGrammarID\":2},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":10,\"nextGrammarID\":2},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":13,\"nextGrammarID\":2},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":9,\"nextGrammarID\":2},{\"event\":\"startElementGeneric\",\"nextGrammarID\":2}]},{\"grammarID\":\"2\",\"type\":\"docEnd\",\"production\":[{\"event\":\"endDocument\",\"nextGrammarID\":-1}]},{\"grammarID\":\"3\",\"type\":\"fragment\",\"production\":[{\"event\":\"startDocument\",\"nextGrammarID\":4}]},{\"grammarID\":\"4\",\"type\":\"fragmentContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":2,\"startElementGrammarID\":14,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":5,\"startElementGrammarID\":17,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":6,\"startElementGrammarID\":15,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":7,\"startElementGrammarID\":19,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":8,\"startElementGrammarID\":18,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":25,\"nextGrammarID\":4},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":19,\"startElementGrammarID\":16,\"nextGrammarID\":4},{\"event\":\"startElementGeneric\",\"nextGrammarID\":4},{\"event\":\"endDocument\",\"nextGrammarID\":-1}]},{\"grammarID\":\"5\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":6,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":5,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":9,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":10,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":11,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":12,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":13,\"nextGrammarID\":45},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"6\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":7,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":8,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":20,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":21,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":22,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":23,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":24,\"nextGrammarID\":44},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"7\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":37},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":7,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":8,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":20,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":21,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":22,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":23,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":24,\"nextGrammarID\":44},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"8\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":38},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":6,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":5,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":9,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":10,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":11,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":12,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":13,\"nextGrammarID\":45},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"9\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":2,\"nextGrammarID\":46}]},{\"grammarID\":\"10\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":3,\"nextGrammarID\":46}]},{\"grammarID\":\"11\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":5,\"nextGrammarID\":46}]},{\"grammarID\":\"12\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"13\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":2,\"startElementGrammarID\":14,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":6,\"startElementGrammarID\":15,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":19,\"startElementGrammarID\":16,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":5,\"startElementGrammarID\":17,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":8,\"startElementGrammarID\":18,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":7,\"startElementGrammarID\":19,\"nextGrammarID\":46}]},{\"grammarID\":\"14\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":7,\"nextGrammarID\":46}]},{\"grammarID\":\"15\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":8,\"nextGrammarID\":46}]},{\"grammarID\":\"16\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":9,\"nextGrammarID\":46}]},{\"grammarID\":\"17\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":10,\"nextGrammarID\":46}]},{\"grammarID\":\"18\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":11,\"nextGrammarID\":46}]},{\"grammarID\":\"19\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":12,\"nextGrammarID\":46}]},{\"grammarID\":\"20\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":39},{\"event\":\"characters\",\"charactersDatatypeID\":2,\"nextGrammarID\":46}]},{\"grammarID\":\"21\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":40},{\"event\":\"characters\",\"charactersDatatypeID\":3,\"nextGrammarID\":46}]},{\"grammarID\":\"22\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":41},{\"event\":\"characters\",\"charactersDatatypeID\":5,\"nextGrammarID\":46}]},{\"grammarID\":\"23\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":42},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"24\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":43},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":2,\"startElementGrammarID\":14,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":6,\"startElementGrammarID\":15,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":19,\"startElementGrammarID\":16,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":5,\"startElementGrammarID\":17,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":8,\"startElementGrammarID\":18,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":7,\"startElementGrammarID\":19,\"nextGrammarID\":46}]},{\"grammarID\":\"25\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":true,\"isNillable\":true,\"production\":[{\"event\":\"attribute\",\"attributeNamespaceID\":0,\"attributeLocalNameID\":0,\"attributeDatatypeID\":0,\"nextGrammarID\":25},{\"event\":\"attributeGeneric\",\"nextGrammarID\":25},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":2,\"startElementGrammarID\":14,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":5,\"startElementGrammarID\":17,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":6,\"startElementGrammarID\":15,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":7,\"startElementGrammarID\":19,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":8,\"startElementGrammarID\":18,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":19,\"startElementGrammarID\":16,\"nextGrammarID\":48},{\"event\":\"startElementGeneric\",\"nextGrammarID\":48},{\"event\":\"endElement\",\"nextGrammarID\":-1},{\"event\":\"charactersGeneric\",\"nextGrammarID\":48}]},{\"grammarID\":\"26\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":13,\"nextGrammarID\":46}]},{\"grammarID\":\"27\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"attributeGeneric\",\"nextGrammarID\":27},{\"event\":\"startElementGeneric\",\"nextGrammarID\":49},{\"event\":\"endElement\",\"nextGrammarID\":-1},{\"event\":\"charactersGeneric\",\"nextGrammarID\":49}]},{\"grammarID\":\"28\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":15,\"nextGrammarID\":46}]},{\"grammarID\":\"29\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":17,\"nextGrammarID\":46}]},{\"grammarID\":\"30\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":18,\"nextGrammarID\":46}]},{\"grammarID\":\"31\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":19,\"nextGrammarID\":46}]},{\"grammarID\":\"32\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":20,\"nextGrammarID\":46}]},{\"grammarID\":\"33\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":21,\"nextGrammarID\":46}]},{\"grammarID\":\"34\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":22,\"nextGrammarID\":46}]},{\"grammarID\":\"35\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":23,\"nextGrammarID\":46}]},{\"grammarID\":\"36\",\"type\":\"firstStartTagContent\",\"isTypeCastable\":false,\"isNillable\":false,\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":24,\"nextGrammarID\":46}]},{\"grammarID\":\"37\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":7,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":8,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":20,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":21,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":22,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":23,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":24,\"nextGrammarID\":44},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"38\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":6,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":5,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":9,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":10,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":11,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":12,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":13,\"nextGrammarID\":45},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"39\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":2,\"nextGrammarID\":46}]},{\"grammarID\":\"40\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":3,\"nextGrammarID\":46}]},{\"grammarID\":\"41\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"characters\",\"charactersDatatypeID\":5,\"nextGrammarID\":46}]},{\"grammarID\":\"42\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"43\",\"type\":\"startTagContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":2,\"startElementGrammarID\":14,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":6,\"startElementGrammarID\":15,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":19,\"startElementGrammarID\":16,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":5,\"startElementGrammarID\":17,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":8,\"startElementGrammarID\":18,\"nextGrammarID\":46},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":7,\"startElementGrammarID\":19,\"nextGrammarID\":46}]},{\"grammarID\":\"44\",\"type\":\"elementContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":7,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":8,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":20,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":21,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":22,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":23,\"nextGrammarID\":44},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":24,\"nextGrammarID\":44},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"45\",\"type\":\"elementContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":6,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":5,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":9,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":10,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":11,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":12,\"nextGrammarID\":45},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":13,\"nextGrammarID\":45},{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"46\",\"type\":\"elementContent\",\"production\":[{\"event\":\"endElement\",\"nextGrammarID\":-1}]},{\"grammarID\":\"47\",\"type\":\"elementContent\",\"production\":[]},{\"grammarID\":\"48\",\"type\":\"elementContent\",\"production\":[{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":0,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":2,\"startElementGrammarID\":14,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":3,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":5,\"startElementGrammarID\":17,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":6,\"startElementGrammarID\":15,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":7,\"startElementGrammarID\":19,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":8,\"startElementGrammarID\":18,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":9,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":11,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":13,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":15,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":17,\"startElementGrammarID\":25,\"nextGrammarID\":48},{\"event\":\"startElement\",\"startElementNamespaceID\":4,\"startElementLocalNameID\":19,\"startElementGrammarID\":16,\"nextGrammarID\":48},{\"event\":\"startElementGeneric\",\"nextGrammarID\":48},{\"event\":\"endElement\",\"nextGrammarID\":-1},{\"event\":\"charactersGeneric\",\"nextGrammarID\":48}]},{\"grammarID\":\"49\",\"type\":\"elementContent\",\"production\":[{\"event\":\"startElementGeneric\",\"nextGrammarID\":49},{\"event\":\"endElement\",\"nextGrammarID\":-1},{\"event\":\"charactersGeneric\",\"nextGrammarID\":49}]}]}}',jsonGrammarsObject=JSON.parse(jsonGrammars);";
	
}


